{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '42030111-51447223cbabab8b20d1b63f9';\nlet currentPage = 1;\nlet searchWord = '';\nconst perPage = 15;\n\nconst refs = {\n  form: document.querySelector('.form'),\n  list: document.querySelector('.gallery-list'),\n  loader: document.querySelector('.loader'),\n  loaderMore: document.querySelector('.loader-more'),\n  btnUp: document.querySelector('.up-btn'),\n  loadMore: document.querySelector('.load-more'),\n};\n\nrefs.loader.style.display = 'none';\nrefs.loaderMore.style.display = 'none';\nrefs.loadMore.style.display = 'none';\nrefs.btnUp.style.display = 'none';\n\nrefs.form.addEventListener('submit', handleSearch);\nrefs.loadMore.addEventListener('click', handleLoad);\n\nconst simplelightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction handleSearch(evt) {\n  evt.preventDefault();\n\n  const form = evt.currentTarget;\n  const searchWord = form.elements.search.value.trim();\n\n  currentPage = 1;\n  refs.list.innerHTML = '';\n  refs.loader.style.display = 'block';\n  refs.loadMore.style.display = 'none';\n  refs.loaderMore.style.display = 'none';\n\n  if (!searchWord) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter something in the search',\n    });\n    refs.loader.style.display = 'none';\n    return;\n  }\n  searchPhotoByName(searchWord, currentPage)\n    .then(data => {\n      const arr = data.hits;\n      if (!arr.length) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        return;\n      }\n      const totalPages = Math.ceil(data.totalHits / perPage);\n\n      if (currentPage === totalPages) {\n        refs.loaderMore.style.display = 'none';\n        refs.loadMore.style.display = 'block';\n      } else {\n        refs.loadMore.style.display = 'block';\n      }\n\n      refs.list.insertAdjacentHTML('beforeend', createMarkup(arr));\n      simplelightbox.refresh();\n    })\n    .catch(err => {\n      iziToast.error({\n        title: 'Error',\n        message: `${err}`,\n      });\n    })\n    .finally(() => {\n      form.reset();\n      refs.loader.style.display = 'none';\n    });\n}\n\nfunction handleLoad() {\n  currentPage += 1;\n\n  refs.loaderMore.style.display = 'block';\n  refs.loadMore.style.display = 'none';\n\n  searchPhotoByName(searchWord, currentPage)\n    .then(data => {\n      const arr = data.hits;\n      refs.list.insertAdjacentHTML('beforeend', createMarkup(arr));\n      simplelightbox.refresh();\n\n      const totalPages = Math.ceil(data.totalHits / perPage);\n\n      if (currentPage === totalPages) {\n        iziToast.info({\n          title: 'Caution',\n          message: `We're sorry, but you've reached the end of search results.`,\n        });\n        refs.loadMore.style.display = 'none';\n        refs.loaderMore.style.display = 'none';\n      }\n      refs.loaderMore.style.display = 'none';\n      refs.loadMore.style.display = 'block';\n\n      return;\n    })\n    .catch(err => console.log(err));\n}\n\nfunction searchPhotoByName(searchWord) {\n  const urlParams = new URLSearchParams({\n    key: API_KEY,\n    q: searchWord,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: perPage,\n    page: 1,\n  });\n\n  return fetch(`${BASE_URL}?${urlParams}`).then(resp => {\n    if (!resp.ok) {\n      throw new Error(resp.statusText);\n    }\n    return resp.json();\n  });\n}\n\nfunction createMarkup(arr) {\n  return arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-img\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n\n            />\n          </a>\n          <div class=\"wrapper\">\n            <div class=\"wrap\">\n              <h2 class=\"header\">Likes</h2>\n              <p class=\"numbers\">${likes}</p>\n            </div>\n            <div class=\"wrap\">\n              <h2 class=\"header\">Views</h2>\n              <p class=\"numbers\">${views}</p>\n            </div>\n            <div class=\"wrap\">\n              <h2 class=\"header\">Comments</h2>\n              <p class=\"numbers\">${comments}</p>\n            </div>\n            <div class=\"wrap\">\n              <h2 class=\"header\">Downloads</h2>\n              <p class=\"numbers\">${downloads}</p>\n            </div>\n          </div>\n        </li>`\n    )\n    .join('');\n}\n"],"names":["BASE_URL","API_KEY","currentPage","searchWord","perPage","refs","handleSearch","handleLoad","simplelightbox","SimpleLightbox","evt","form","iziToast","searchPhotoByName","data","arr","totalPages","createMarkup","err","urlParams","resp","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}